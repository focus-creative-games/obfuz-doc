<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-manual/encryption" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">加密 | Obfuz</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.obfuz.com/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://www.obfuz.com/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://www.obfuz.com/docs/manual/encryption"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="加密 | Obfuz"><meta data-rh="true" name="description" content="加密是Obfuz的核心机制，绝大多数Obfuscation Pass都跟加密有关，原因如下："><meta data-rh="true" property="og:description" content="加密是Obfuz的核心机制，绝大多数Obfuscation Pass都跟加密有关，原因如下："><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://www.obfuz.com/docs/manual/encryption"><link data-rh="true" rel="alternate" href="https://www.obfuz.com/docs/manual/encryption" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.obfuz.com/docs/manual/encryption" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.ff9dae79.css">
<script src="/assets/js/runtime~main.497e49ad.js" defer="defer"></script>
<script src="/assets/js/main.ebeee206.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Obfuz Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="Obfuz Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Obfuz</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">文档</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/focus-creative-games/obfuz" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">简介</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/getting-started">入门</a><button aria-label="Expand sidebar category &#x27;入门&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/manual">手册</a><button aria-label="Collapse sidebar category &#x27;手册&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/manual/installation">安装</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/manual/configuration">设置</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/manual/menu">Editor菜单</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/manual/assembly">程序集</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/manual/encryption">加密</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/manual/obfuscation-pass">Obfuscation Pass</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/manual/obfuzignore">ObfuzIgnoreAttribute</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/manual/symbol-obfuscation">符号混淆</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/manual/const-encryption">常量加密</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/manual/field-encryption">字段加密</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/manual/call-obfuscation">函数调用混淆</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/manual/build-pipeline">构建过程中执行混淆</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/manual/run-obfuscation-standalonely">单独执行混淆</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/manual/incremental-obfuscation-and-hotupdate">增量混淆与代码热更新</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/manual/serialization-reflection">反射与序列化</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/manual/deobfuscate-stacktrace">还原混淆堆栈日志</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/help">帮助</a><button aria-label="Expand sidebar category &#x27;帮助&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/manual"><span itemprop="name">手册</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">加密</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>加密</h1></header>
<p>加密是Obfuz的核心机制，绝大多数Obfuscation Pass都跟加密有关，原因如下：</p>
<ul>
<li>常量加密之类的直接涉及到数据加密功能必然要用到加密相关机制</li>
<li>函数调用混淆之类的混淆Pass会利用延迟（即第一次执行到该代码时）解密一些关键参数来阻止离线破解</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="iencryptor">IEncryptor<a href="#iencryptor" class="hash-link" aria-label="Direct link to IEncryptor" title="Direct link to IEncryptor">​</a></h2>
<p>Obfuz在一个IEncryptor基础加密接口上构建了整个加密机制。</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">namespace Obfuz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public interface IEncryptor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int OpCodeCount { get; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        void EncryptBlock(byte[] data, int ops, int salt);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        void DecryptBlock(byte[] data, int ops, int salt);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int Encrypt(int value, int opts, int salt);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int Decrypt(int value, int opts, int salt);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        long Encrypt(long value, int opts, int salt);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        long Decrypt(long value, int opts, int salt);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        float Encrypt(float value, int opts, int salt);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        float Decrypt(float value, int opts, int salt);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        double Encrypt(double value, int opts, int salt);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        double Decrypt(double value, int opts, int salt);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] Encrypt(byte[] value, int offset, int length, int opts, int salt);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] Decrypt(byte[] value, int offset, int byteLength, int ops, int salt);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        byte[] Encrypt(string value, int ops, int salt);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        string DecryptString(byte[] value, int offset, int stringBytesLength, int ops, int salt);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>任何一个加密或者解密操作都涉及到3个数据：</p>
<ul>
<li>data 原始数据或者加密后的数据</li>
<li>ops 加密或者解密操作</li>
<li>salt 额外的随机参数</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="加密指令组-ops">加密指令组 ops<a href="#加密指令组-ops" class="hash-link" aria-label="Direct link to 加密指令组 ops" title="Direct link to 加密指令组 ops">​</a></h2>
<p>加了增加破解难度，Obfuz不使用固定的加密代码，而是提前生成好固定的MaxOpCount个（默认256个，可自定义配置）加密指令。
对每个加密对象都生成一组的随机加密（或解密）指令 op1、op2、 .. opn。</p>
<p>为了简化实现同时避免过度影响性能，我们限制了加密操作不超过4个，它们一般可以编码为一个整数，即Encrypt或Decrypt函数中的<code>int ops</code>参数。</p>
<p>最终ops的计算方式如以下代码：</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int GenerateOps(uint[] opArr)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  uint ops = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  for (int i = opArr.Length - 1; i &gt;= 0; i--)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ops *= MaxOpCount;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ops |= opArr[i];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return (int)ops;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>由于解密是加密的逆序操作，使用逆序编码ops的算法方便运行时解密时以正序解码ops，提高运行效率，毕竟运行时解密的操作比加密操作要多得多。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="encryptionvm">EncryptionVM<a href="#encryptionvm" class="hash-link" aria-label="Direct link to EncryptionVM" title="Direct link to EncryptionVM">​</a></h2>
<p>Obfuz中的加密服务需要满足以下需求：</p>
<ol>
<li>实现IEncryptor中所有接口。</li>
<li>支持加密指令组 ops机制。</li>
<li>多态化，即每个开发者都能生成独一无二的加密代码，增大破解难度。</li>
</ol>
<p>我们通过根据一个随机化种子生成EncryptionVM来实现这些目标。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="加密指令集">加密指令集<a href="#加密指令集" class="hash-link" aria-label="Direct link to 加密指令集" title="Direct link to 加密指令集">​</a></h3>
<p>为了支持加密指令组ops机制，EncryptionVM需要包含一套固定的加密指令。</p>
<p>EncryptionVM支持以下加密指令原语：</p>
<ul>
<li>Add</li>
<li>Multiple</li>
<li>Xor</li>
<li>BitRotate</li>
<li>AddRotateXor</li>
<li>AddXorRotate</li>
<li>MultipleRotateXor</li>
<li>MultipleXorRotate</li>
<li>XorAddRotate</li>
<li>XorMultipleRotate</li>
</ul>
<p>每个加密指令原语都有一些随机化参数，可确保每条加密指令都不一样。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="生成加密指令集">生成加密指令集<a href="#生成加密指令集" class="hash-link" aria-label="Direct link to 生成加密指令集" title="Direct link to 生成加密指令集">​</a></h3>
<p>Obfuz使用一个确定性的随机算法，根据一个初始的随机种子，生成加密指令集。</p>
<ul>
<li><code>EncryptionVMSettings.CodeGenerationSecretKey</code>中配置这个初始的随机化种子。</li>
<li><code>EncryptionVMSettings.EncryptionOpCodeCount</code>中配置了加密指令集的指令个数。</li>
</ul>
<p>EncrytpionOpCodeCount必须为2的幂（如64、128、256、1024），默认值为256。最小值为64，最大值虽然没有限制，但不建议超出1024，因为会导致生成的<code>GeneratedEncryptionVirutalMachine</code>类的代码过大。</p>
<p>生成算法会随机出每条指令使用的加密指令原语以及该加密原语的随机化参数。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="生成-encryptionvm代码">生成 EncryptionVM代码<a href="#生成-encryptionvm代码" class="hash-link" aria-label="Direct link to 生成 EncryptionVM代码" title="Direct link to 生成 EncryptionVM代码">​</a></h3>
<p>运行菜单<code>Obfuz/GenerateEncryptionVM</code>生成加密虚拟机代码，在<code>EncryptionVMSettings.CodeOutputPath</code>中配置<code>GeneratedEncryptionVirtualMachine</code>类的输出代码文件路径。
默认生成的代码文件为<code>Assets/Obfuz/GeneratedEncryptionVirtualMachine.cs</code>。</p>
<p>一般来说，GeneratedEncryptionVirutalMachine需要放到AOT程序集中。这样既提高了加密性能，同时也利用il2cpp会将代码编译为机器指令的特点，增加破解难度。</p>
<p>如果没有任何AOT混淆程序集，GeneratedEncryptionVirutalMachine也可以放到热更新程序集中，这样可以实现最大程度的灵活性，每次发布热更新代码时加密虚拟机都不一样。不过放到热更新代码中
不仅会导致加密性能较差，还容易被逆向，因此不推荐这么做。</p>
<p>建议每次发布新主包时修改<code>CodeGenerationSecretKey</code>，生成全新的EncryptionVM，以增大破解难度。如果使用了代码热更新技术且<code>GeneratedEncryptionVirutalMachine</code>在AOT程序集中，
那么在发布热更新代码时不要修改<code>CodeGenerationSecretKey</code>，否则会导致被混淆的热更新程序集执行解密代码出错！</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="encryptionservice">EncryptionService<a href="#encryptionservice" class="hash-link" aria-label="Direct link to EncryptionService" title="Direct link to EncryptionService">​</a></h2>
<p>Obfuz通过EncryptionSerivce类提供统一的加密和解密服务。它的实现很简单，有一个<code>IEncryptor _encryptor</code>变量，通过转发调用<code>_encryptor</code>中的接口函数实现具体的加解密服务。</p>
<p>截取EncryptionService的部分代码如下：</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">namespace Obfuz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static class EncryptionService&lt;T&gt; where T : IEncryptionScope</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // for compatibility with Mono because Mono will raise FieldAccessException when try access private field</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public static IEncryptor _encryptor;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public static IEncryptor Encryptor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            get =&gt; _encryptor;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            set { _encryptor = value; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public static void EncryptBlock(byte[] data, int ops, int salt)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _encryptor.EncryptBlock(data, ops, salt);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public static void DecryptBlock(byte[] data, int ops, int salt)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _encryptor.DecryptBlock(data, ops, salt);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ....</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>以常量加密为例， <code>int a = 5;</code> 经过常量加密后变成 <code>int a = Obfuz.EncryptionService&lt;Obfuz.DefaultStaticSecretScope&gt;.Decrypt(11231312, 98978274, 2342342)</code>。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="初始化encryptor">初始化Encryptor<a href="#初始化encryptor" class="hash-link" aria-label="Direct link to 初始化Encryptor" title="Direct link to 初始化Encryptor">​</a></h3>
<p>一般会给EncryptionService.Encryptor赋值<code>GeneratedEncryptionVirtualMachine</code>实例，示例代码如下。</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [ObfuzIgnore]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [RuntimeInitializeOnLoadMethod(RuntimeInitializeLoadType.AfterAssembliesLoaded)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static void SetUpStaticSecret()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        EncryptionService&lt;DefaultStaticEncryptionScope&gt;.Encryptor = new GeneratedEncryptionVirtualMachine(Resources.Load&lt;TextAsset&gt;(&quot;Obfuz/defaultStaticSecretKey&quot;).bytes);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ... 初始化其他EncryptionScope</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>GeneratedEncryptionVirtualMachine需要一个长度1024的<code>byte[]</code>密钥参数。由于这个密钥比较长，没有选择直接生成，而是基于一个起始密钥字符串，通过哈希算法计算出最终的密钥。</p>
<p>Obfuz调用<code>Obfuz.Utils.KeyGenerator::GenerateKey</code>函数来生成密钥，代码如下：</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">namespace Obfuz.Utils</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public static class KeyGenerator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        public static byte[] GenerateKey(string initialString, int keyLength)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte[] initialBytes = Encoding.UTF8.GetBytes(initialString);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            using (var sha512 = SHA512.Create())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                byte[] hash = sha512.ComputeHash(initialBytes);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                byte[] key = new byte[keyLength];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                int bytesCopied = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                while (bytesCopied &lt; key.Length)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    if (bytesCopied &gt; 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        // 再次哈希之前的哈希值以生成更多数据</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        hash = sha512.ComputeHash(hash);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    int bytesToCopy = Math.Min(hash.Length, key.Length - bytesCopied);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    Buffer.BlockCopy(hash, 0, key, bytesCopied, bytesToCopy);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    bytesCopied += bytesToCopy;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                return key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="encryptionscope">EncryptionScope<a href="#encryptionscope" class="hash-link" aria-label="Direct link to EncryptionScope" title="Direct link to EncryptionScope">​</a></h2>
<p>游戏项目为了增加破解难度，希望使用多个密钥。又如项目中使用了代码热更新，很有可能希望热更新代码使用的加密密钥和AOT中的不一样，并且希望这个密钥可以热更新完成后再加载，而不是必须启动时就加载。
Obfuz通过EncryptionScope来实现这个功能。</p>
<p>通过运行时为不同的<code>EncryptionService&lt;{EncryptionScope}&gt;</code>设置不同的<code>IEncryptor</code>实例，可以实现使用多个不同的密钥，示例代码如下：</p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [ObfuzIgnore]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [RuntimeInitializeOnLoadMethod(RuntimeInitializeLoadType.AfterAssembliesLoaded)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static void SetUpStaticSecret()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        EncryptionService&lt;DefaultStaticEncryptionScope&gt;.Encryptor = new GeneratedEncryptionVirtualMachine(Resources.Load&lt;TextAsset&gt;(&quot;Obfuz/defaultStaticSecretKey&quot;).bytes);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 设置其他静态EncryptionScope的Encryptor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static void SetUpDynamicSecret()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        EncryptionService&lt;DefaultDynamicEncryptionScope&gt;.Encryptor = new GeneratedEncryptionVirtualMachine(Resources.Load&lt;TextAsset&gt;(&quot;Obfuz/defaultDynamicSecretKey&quot;).bytes);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 设置其他动态EncryptionScope的Encryptor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>每个程序集只能对应一个EncryptionScope，即你无法为一个程序集中的部分代码使用EncryptionScopeA，为另一个部分代码使用EncryptionScopeB。每个被混淆的程序集默认使用<code>DefaultStaticEncryptionScope</code>，
即使用<code>SecretSettings.DefaultStaticSecretKey</code>密钥。如果将某个程序集名添加到<code>SecretSettings.AssembliesUseDynamicSecretKeys</code>列表，则这种程序集使用<code>DefaultDynamicEncryptionScope</code>。</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p><code>EncryptionService&lt;DefaultStaticEncryptionScope&gt;.Encryptor</code>必须使用DefaultStaticSecretKey初始化，
<code>EncryptionService&lt;DefaultDynamicEncryptionScope&gt;.Encryptor</code>必须使用DefaultDynamicSecretKey初始化，
两者不可混用！</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="secret-key">Secret Key<a href="#secret-key" class="hash-link" aria-label="Direct link to Secret Key" title="Direct link to Secret Key">​</a></h2>
<p>当前版本仅支持两个密钥： defaultStaticSecretKey和defaultDynamicSecretKey，后续版本会支持任何多个密钥。</p>
<p>在<code>ObfuzSettings.SecretSettings</code>中可配置<code>DefaultStaticSecretKey</code>和<code>DefaultDynamicSecretKey</code>。</p>
<p>菜单<code>Obfuz/GenerateSecretKey</code>会为这两个密钥生成defaultStaticSecretKey.bytes和defaultDynamicSecretKey.bytes文件。可在<code>SecretSettings.SecretKeyOutputPath</code>可以配置密钥文件的输出目录。</p>
<p>如果混淆了某些AOT程序集，由于AOT程序集中的代码在很早期就可能被执行到，如此不能在执行这些程序集中的混淆或者加密代码前就为它们所属的<code>EncryptionService&lt;{EncryptionScope}&gt;</code>设置Encryptor，
会产生运行异常。建议是尽可能早执行<code>EncryptionService&lt;{EncryptionScope}&gt;.Encrypor</code>的初始化代码。一个比较合理的方式是使用<code>[RuntimeInitializeOnLoadMethod(RuntimeInitializeLoadType.AfterAssembliesLoaded)]</code>
在CLR（il2cpp或mono）运行时加载完所有程序集后就运行EncryptionService的初始化代码。</p>
<p>显然，不应该混淆<code>SetUpStaticSecret</code>的代码，因为此时EncryptionService还未初始化，这会陷入无限递归。而<code>SetUpDynamicSecret</code>则可以被混淆，因此它一般在满足某些条件后（比如热更新完成后）才被调用。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="salt">salt<a href="#salt" class="hash-link" aria-label="Direct link to salt" title="Direct link to salt">​</a></h2>
<p>Encryt或Decrypt中的salt是一个随机生成的参数，取值范围为<code>[int.MinValue, int.MaxValue]</code>。它作为一个额外的参数用于增加加密和解密操作的复杂性。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="secretsettingsrandomseed">SecretSettings.RandomSeed<a href="#secretsettingsrandomseed" class="hash-link" aria-label="Direct link to SecretSettings.RandomSeed" title="Direct link to SecretSettings.RandomSeed">​</a></h2>
<p>RandomSeed不直接参与加解密过程，但它被用于生成随机的ops、salt以及其他需要随机化的场合。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/manual/encryption.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/manual/assembly"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">程序集</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/manual/obfuscation-pass"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Obfuscation Pass</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#iencryptor" class="table-of-contents__link toc-highlight">IEncryptor</a></li><li><a href="#加密指令组-ops" class="table-of-contents__link toc-highlight">加密指令组 ops</a></li><li><a href="#encryptionvm" class="table-of-contents__link toc-highlight">EncryptionVM</a><ul><li><a href="#加密指令集" class="table-of-contents__link toc-highlight">加密指令集</a></li><li><a href="#生成加密指令集" class="table-of-contents__link toc-highlight">生成加密指令集</a></li><li><a href="#生成-encryptionvm代码" class="table-of-contents__link toc-highlight">生成 EncryptionVM代码</a></li></ul></li><li><a href="#encryptionservice" class="table-of-contents__link toc-highlight">EncryptionService</a><ul><li><a href="#初始化encryptor" class="table-of-contents__link toc-highlight">初始化Encryptor</a></li></ul></li><li><a href="#encryptionscope" class="table-of-contents__link toc-highlight">EncryptionScope</a></li><li><a href="#secret-key" class="table-of-contents__link toc-highlight">Secret Key</a></li><li><a href="#salt" class="table-of-contents__link toc-highlight">salt</a></li><li><a href="#secretsettingsrandomseed" class="table-of-contents__link toc-highlight">SecretSettings.RandomSeed</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">文档</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">入门</a></li></ul></div><div class="col footer__col"><div class="footer__title">社区</div><ul class="footer__items clean-list"></ul></div><div class="col footer__col"><div class="footer__title">相关项目</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/focus-creative-games/hybridclr" target="_blank" rel="noopener noreferrer" class="footer__link-item">HybridCLR<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/focus-creative-games/luban" target="_blank" rel="noopener noreferrer" class="footer__link-item">Luban<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Code Philosophy, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>